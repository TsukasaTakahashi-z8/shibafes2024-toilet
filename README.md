# 芝生祭トイレ混雑状況システム

このコードは、トイレの混雑状況を取得するためのコードです。  
詳細は、以下のdoc内ドキュメントを参照してください。

- [トイレの混雑状況システム導入について.pdf](./doc/トイレの混雑状況システム導入について.pdf)

# ハードウェア構成

以下の4種類を準備します。(nは1トイレあたりの個室の数)

| 名称                | 個数 |
|---------------------|------|
| Raspberry Pi Pico W | n+1  |
| 電源モジュール      | n+1  |
| 表示器              | 1    |
| センサモジュール    | n    |

子機(n個)と親機(1機)の２種類があり、子機は

- Raspberry Pi Pico W
- 電源モジュール
- センサモジュール

の各一個からなり、親機は

- Raspberry Pi Pico W
- 電源モジュール
- 表示器

の各一個から構成されます。

## RaspberryPi Pico W

RaspberryPi Pico W は、親機１つと子機n個から構成されます。

### 親機用

親機用は、

- 子機接続用LANルータ
- 子機とのWEBSocket通信のサーバ
- 表示器の制御

の役割を担います。

#### Pin配列

| Pin      | もの      |
| -------- | --------- |
| VSYS(22) | Batt(+)   |
| GP14(23) | Batt(-)   |
+ LED

### 子機用

子機用は、

- センサの情報取得
- 親機への取得情報送信(WEBSocket client)

を行います。

#### Pin配列

| Pin      | もの      |
| -------- | --------- |
| GP1 (2)  | センサ    |
| GND (8)  | センサ    | 
| GP13(17) | LED(Blue) |
| GND (18) | LED(GND)  |
| GP14(19) | LED(Red)  |
| VSYS(22) | Batt(+)   |
| GP14(23) | Batt(-)   |

## 電源モジュール

電源モジュールは、親機または子機のRaspberryPiPicoに電源を供給します。  
単三電池のソケットです。

## センサモジュール

センサモジュールは、リードスイッチと磁石から構成されます。

| ドア状態 | センサ状態 | bool  |
|----------|------------|-------|
| 開       | 開         | true  |
| 閉       | 閉         | false |
